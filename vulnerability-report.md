#  Vulnerability Assessment Report

**Assessment Date**: July 30, 2025  
**Tool Used**: Nmap (Aggressive scan using `-A` option)  
**Environment**: Local virtual lab with 4 VMs 

---

## 1. Objective

This assessment was conducted to identify exposed services, running versions, OS details, and potential vulnerabilities across four isolated virtual machines. The goal was to simulate a basic internal network scan using open-source tools and to provide actionable hardening recommendations based on findings.

---

## 2. Host Overview

| Hostname  | OS         | Observations             |
|-----------|------------|--------------------------|
| WIN-VM1   | Windows 7  | SMBv2, RPC, HTTPAPI open |
| WIN-VM2   | Windows Server 2016 | SMB signing enabled but not enforced |
| WIN-VM3   | Windows Server 2012 R2 | Vulnerable to EternalBlue (CVE-2017-0144) |
| LINUX-VM  | Debian-based Linux | No open ports — hardened host |

---

## 3. Methodology

- Run `nmap -A <ip>` on each host individually
- Detected OS, services, versions, and network configurations
- Used NSE scripts like `smb-security-mode` and `smb-vuln-ms17-010` for deeper checks
- Analyzed and correlated with known vulnerabilities (CVEs)
- Evaluated each host's security posture and mapped to real-world risks

---

## 4. Findings Summary

###  WIN-VM1 (X.X.X.X)
- **Open Ports**: 135 (RPC), 139, 445 (SMBv2), 5357 (HTTPAPI)
- **Risks**:
  - HTTPAPI unnecessarily exposed
  - RPC is a common RCE vector if unpatched
  - SMBv2 detected, no indication of enforced message signing

###  WIN-VM2 (X.X.X.X)
- **Open Ports**: 135 (RPC), 139, 445 (SMBv2), 5357 (HTTPAPI)
- **Risks**:
  - SMB signing is **enabled**, but **not required** (allows MITM)
  - No major vulnerabilities detected, but misconfigurations exist

###  WIN-VM3 (X.X.X.X)
- **Open Ports**:135 (RPC), 139, 445 (SMBv2), 5357 (HTTPAPI)
- **Risks**:
  - **EternalBlue vulnerability detected** (MS17-010, CVE-2017-0144)
  - High potential for **remote code execution** and **lateral movement**

###  LINUX-VM (X.X.X.X)
- **Result**: All 1000 scanned TCP ports closed
- **Status**: Secure; minimal attack surface

---

## 5. Key Risks Identified

- Open SMB (port 445) and RPC (135) — major exploit vectors
- Lack of **mandatory SMB signing** → MITM and tampering risk
- **Legacy or unused services** (HTTPAPI) unnecessarily increasing attack surface
- EternalBlue vulnerability still active on one host

---

## 6. Remediation Recommendations

| Recommendation                          | Priority |
|----------------------------------------|----------|
| Apply all latest Windows security updates | High |
| Disable SMBv1 completely                 | High |
| Enforce SMB message signing             | High |
| Block ports 135, 445, and 5357 from untrusted sources | High |
| Disable HTTPAPI unless needed           | Medium |
| Audit and remove any guest/anonymous share access | High |

---

## 7. Real-World Exploit References

- **WannaCry Ransomware** exploited SMBv1 via EternalBlue (CVE-2017-0144)
- **NotPetya** used SMB and lateral movement for destructive purposes
- **PrintNightmare** (CVE-2021-34527) exploited exposed printer services (via port 5357 in some cases)

---

## 8. Mapping to Security Standards

| Framework | Relevance |
|-----------|-----------|
| **OWASP** | Covers security misconfigurations (A05) and excessive exposure |
| **NIST CSF** | Aligns with identify, protect, and detect functions |
| **CIS Controls** | Control 4 (secure configuration), Control 7 (vulnerability management) |
| **ISO/IEC 27001** | Technical controls for access restriction and hardening |

---

## 9. Lessons Learned

- Even default Windows installations expose critical services
- A single unpatched host (WIN-VM3) can compromise entire network security
- Proper configuration and minimal exposure drastically improve security (as seen in LINUX-VM)

---

## 10. Artifacts

- See `nmap-scan-output.txt` for raw scan data
- See `references.md` for all cited frameworks, tools, and vulnerabilities
- Screenshots of terminal and VM structure included in `/screenshots`

---

